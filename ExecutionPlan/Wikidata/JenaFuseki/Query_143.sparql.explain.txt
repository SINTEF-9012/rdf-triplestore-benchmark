12:38:25 INFO  exec            :: QUERY
  PREFIX  schema: <http://schema.org/>
  PREFIX  pq:   <http://www.wikidata.org/prop/qualifier/>
  PREFIX  bd:   <http://www.bigdata.com/rdf#>
  PREFIX  pr:   <http://www.wikidata.org/prop/reference/>
  PREFIX  ps:   <http://www.wikidata.org/prop/statement/>
  PREFIX  owl:  <http://www.w3.org/2002/07/owl#>
  PREFIX  geof: <http://www.opengis.net/def/geosparql/function/>
  PREFIX  wdt:  <http://www.wikidata.org/prop/direct/>
  PREFIX  wds:  <http://www.wikidata.org/entity/statement/>
  PREFIX  wdv:  <http://www.wikidata.org/value/>
  PREFIX  xsd:  <http://www.w3.org/2001/XMLSchema#>
  PREFIX  skos: <http://www.w3.org/2004/02/skos/core#>
  PREFIX  psn:  <http://www.wikidata.org/prop/statement/value-normalized/>
  PREFIX  rdfs: <http://www.w3.org/2000/01/rdf-schema#>
  PREFIX  pqn:  <http://www.wikidata.org/prop/qualifier/value-normalized/>
  PREFIX  wd:   <http://www.wikidata.org/entity/>
  PREFIX  geo:  <http://www.opengis.net/ont/geosparql#>
  PREFIX  psv:  <http://www.wikidata.org/prop/statement/value/>
  PREFIX  dct:  <http://purl.org/dc/terms/>
  PREFIX  pqv:  <http://www.wikidata.org/prop/qualifier/value/>
  PREFIX  ontolex: <http://www.w3.org/ns/lemon/ontolex#>
  PREFIX  wdata: <http://www.wikidata.org/wiki/Special:EntityData/>
  PREFIX  wdref: <http://www.wikidata.org/reference/>
  PREFIX  prov: <http://www.w3.org/ns/prov#>
  PREFIX  cc:   <http://creativecommons.org/ns#>
  PREFIX  wikibase: <http://wikiba.se/ontology#>
  PREFIX  prn:  <http://www.wikidata.org/prop/reference/value-normalized/>
  PREFIX  p:    <http://www.wikidata.org/prop/>
  PREFIX  wdtn: <http://www.wikidata.org/prop/direct-normalized/>
  PREFIX  prv:  <http://www.wikidata.org/prop/reference/value/>
  PREFIX  rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
  PREFIX  hint: <http://www.bigdata.com/queryHints#>
  PREFIX  wdno: <http://www.wikidata.org/prop/novalue/>
  
  SELECT  ?occ ?occLabel ?avgAge ?avgBirthYear ?count
  WHERE
    { { SELECT  ?occ (COUNT(?p) AS ?count) (round(AVG(?birthYear)) AS ?avgBirthYear) (AVG(( ?deathYear - ?birthYear )) AS ?avgAge)
        WHERE
          { { SELECT  ?p ?occ (AVG(year(?birth)) AS ?birthYear) (AVG(year(?death)) AS ?deathYear)
              WHERE
                { ?p  wdt:P31   wd:Q5 ;
                      wdt:P106  ?occ .
                  ?p p:P569/psv:P569 _:b0 .
                  _:b0  wikibase:timePrecision  9 ;
                        wikibase:timeValue    ?birth .
                  ?p p:P570/psv:P570 _:b1 .
                  _:b1  wikibase:timePrecision  9 ;
                        wikibase:timeValue    ?death
                }
              GROUP BY ?p ?occ
            }
          }
        GROUP BY ?occ
      }
      FILTER ( ?count > 300 )
    }
  ORDER BY ASC(?avgAge)
12:38:25 INFO  exec            :: ALGEBRA
  (project (?occ ?occLabel ?avgAge ?avgBirthYear ?count)
    (order ((asc ?avgAge))
      (project (?occ ?count ?avgBirthYear ?avgAge)
        (extend ((?avgBirthYear (round ?/.1)) (?avgAge ?/.2))
          (filter (> ?count 300)
            (extend ((?count ?/.0))
              (group (?occ) ((?/.0 (count ?/p)) (?/.1 (avg ?/birthYear)) (?/.2 (avg (- ?/deathYear ?/birthYear))))
                (project (?/p ?occ ?/birthYear ?/deathYear)
                  (extend ((?/birthYear ?//.0) (?/deathYear ?//.1))
                    (group (?/p ?occ) ((?//.0 (avg (year ?//birth))) (?//.1 (avg (year ?//death))))
                      (quadpattern
                        (quad <urn:x-arq:DefaultGraphNode> ?/p <http://www.wikidata.org/prop/direct/P31> <http://www.wikidata.org/entity/Q5>)
                        (quad <urn:x-arq:DefaultGraphNode> ?/p <http://www.wikidata.org/prop/direct/P106> ?occ)
                        (quad <urn:x-arq:DefaultGraphNode> ?/p <http://www.wikidata.org/prop/P569> ??P0)
                        (quad <urn:x-arq:DefaultGraphNode> ??P0 <http://www.wikidata.org/prop/statement/value/P569> ?//?0)
                        (quad <urn:x-arq:DefaultGraphNode> ?//?0 <http://wikiba.se/ontology#timePrecision> 9)
                        (quad <urn:x-arq:DefaultGraphNode> ?//?0 <http://wikiba.se/ontology#timeValue> ?//birth)
                        (quad <urn:x-arq:DefaultGraphNode> ?/p <http://www.wikidata.org/prop/P570> ??P1)
                        (quad <urn:x-arq:DefaultGraphNode> ??P1 <http://www.wikidata.org/prop/statement/value/P570> ?//?1)
                        (quad <urn:x-arq:DefaultGraphNode> ?//?1 <http://wikiba.se/ontology#timePrecision> 9)
                        (quad <urn:x-arq:DefaultGraphNode> ?//?1 <http://wikiba.se/ontology#timeValue> ?//death)
                      )))))))))))
12:38:25 INFO  exec            :: TDB2
  (project (?occ ?occLabel ?avgAge ?avgBirthYear ?count)
    (order ((asc ?avgAge))
      (project (?occ ?count ?avgBirthYear ?avgAge)
        (extend ((?avgBirthYear (round ?/.1)) (?avgAge ?/.2))
          (filter (> ?count 300)
            (extend ((?count ?/.0))
              (group (?occ) ((?/.0 (count ?/p)) (?/.1 (avg ?/birthYear)) (?/.2 (avg (- ?/deathYear ?/birthYear))))
                (project (?/p ?occ ?/birthYear ?/deathYear)
                  (extend ((?/birthYear ?//.0) (?/deathYear ?//.1))
                    (group (?/p ?occ) ((?//.0 (avg (year ?//birth))) (?//.1 (avg (year ?//death))))
                      (quadpattern
                        (quad <urn:x-arq:DefaultGraphNode> ?/p <http://www.wikidata.org/prop/direct/P31> <http://www.wikidata.org/entity/Q5>)
                        (quad <urn:x-arq:DefaultGraphNode> ?/p <http://www.wikidata.org/prop/direct/P106> ?occ)
                        (quad <urn:x-arq:DefaultGraphNode> ?/p <http://www.wikidata.org/prop/P569> ??P0)
                        (quad <urn:x-arq:DefaultGraphNode> ??P0 <http://www.wikidata.org/prop/statement/value/P569> ?//?0)
                        (quad <urn:x-arq:DefaultGraphNode> ?//?0 <http://wikiba.se/ontology#timePrecision> 9)
                        (quad <urn:x-arq:DefaultGraphNode> ?//?0 <http://wikiba.se/ontology#timeValue> ?//birth)
                        (quad <urn:x-arq:DefaultGraphNode> ?/p <http://www.wikidata.org/prop/P570> ??P1)
                        (quad <urn:x-arq:DefaultGraphNode> ??P1 <http://www.wikidata.org/prop/statement/value/P570> ?//?1)
                        (quad <urn:x-arq:DefaultGraphNode> ?//?1 <http://wikiba.se/ontology#timePrecision> 9)
                        (quad <urn:x-arq:DefaultGraphNode> ?//?1 <http://wikiba.se/ontology#timeValue> ?//death)
                      )))))))))))
12:38:25 INFO  exec            :: Execute
  ?/p <http://www.wikidata.org/prop/direct/P31> <http://www.wikidata.org/entity/Q5>
  ?/p <http://www.wikidata.org/prop/direct/P106> ?occ
  ?/p <http://www.wikidata.org/prop/P569> ??P0
  ??P0 <http://www.wikidata.org/prop/statement/value/P569> ?//?0
  ?//?0 <http://wikiba.se/ontology#timePrecision> 9
  ?//?0 <http://wikiba.se/ontology#timeValue> ?//birth
  ?/p <http://www.wikidata.org/prop/P570> ??P1
  ??P1 <http://www.wikidata.org/prop/statement/value/P570> ?//?1
  ?//?1 <http://wikiba.se/ontology#timePrecision> 9
  ?//?1 <http://wikiba.se/ontology#timeValue> ?//death
